---
import { Menu, X } from "@lucide/astro";

import NavItem from "./navItem.astro";
---

<nav
  class="relative flex h-14 w-full items-center justify-between px-4 sm:h-16 sm:px-6 lg:px-8"
>
  <!-- Logo -->
  <a
    href="#Home"
    class="flex items-center gap-3 transition-transform hover:scale-[1.02]"
  >
    <div
      class="flex items-center justify-center rounded-xl border border-slate-100 bg-white p-1 shadow-sm"
    >
      <img src="/favicon_4.svg" alt="Logo" class="h-7 w-7 sm:h-8 sm:w-8" />
    </div>
    <span
      class="text-lg font-extrabold tracking-tight text-slate-800 sm:text-xl md:text-2xl"
    >
      Tele<span class="text-sky-600">pro</span>
    </span>
  </a>

  <!-- Desktop Navigation -->
  <div class="hidden flex-1 justify-center md:flex">
    <ul class="flex items-center gap-8 lg:gap-12">
      <NavItem
        href="#Home"
        class="text-sm font-bold tracking-wide text-slate-600 transition-colors hover:text-sky-600"
        >Inicio</NavItem
      >
      <NavItem
        href="#Services"
        class="text-sm font-bold tracking-wide text-slate-600 transition-colors hover:text-sky-600"
        >Servicios</NavItem
      >
      <NavItem
        href="#About"
        class="text-sm font-bold tracking-wide text-slate-600 transition-colors hover:text-sky-600"
        >Nosotros</NavItem
      >
    </ul>
  </div>

  <div class="hidden justify-end md:flex">
    <a
      href="#Contact"
      class="inline-flex items-center justify-center rounded-xl bg-slate-900 px-5 py-2.5 text-sm font-bold tracking-wide text-white shadow-sm transition-colors hover:bg-sky-600"
    >
      Contacto
    </a>
  </div>

  <!-- Mobile Menu Button -->
  <button
    id="mobile-menu-toggle"
    class="rounded-xl border border-slate-200 bg-slate-100 p-2.5 text-slate-700 shadow-sm transition-colors hover:bg-slate-200 focus:outline-none md:hidden"
    aria-label="Menú de navegación"
    aria-expanded="false"
    aria-controls="mobile-menu"
  >
    <Menu id="menu-icon" class="h-5 w-5 sm:h-6 sm:w-6" />
    <X id="close-icon" class="hidden h-5 w-5 sm:h-6 sm:w-6" />
  </button>
</nav>

<!-- Mobile Menu Dropdown -->
<div
  id="mobile-menu"
  class="absolute top-full right-0 left-0 z-40 hidden w-full origin-top transform md:hidden"
>
  <div
    class="mx-4 mt-2 mb-4 overflow-hidden rounded-2xl border border-slate-200/60 bg-white/95 shadow-2xl ring-1 ring-black/5 backdrop-blur-xl"
  >
    <ul class="flex flex-col p-2">
      <li>
        <a
          href="#Home"
          class="mobile-link block rounded-xl px-6 py-4 text-base font-bold text-slate-700 transition-colors hover:bg-sky-50 hover:text-sky-600"
          >Inicio</a
        >
      </li>
      <li>
        <a
          href="#Services"
          class="mobile-link block rounded-xl px-6 py-4 text-base font-bold text-slate-700 transition-colors hover:bg-sky-50 hover:text-sky-600"
          >Servicios</a
        >
      </li>
      <li>
        <a
          href="#About"
          class="mobile-link block rounded-xl px-6 py-4 text-base font-bold text-slate-700 transition-colors hover:bg-sky-50 hover:text-sky-600"
          >Sobre Nosotros</a
        >
      </li>
      <li class="mt-2 border-t border-slate-100 p-2">
        <a
          href="#Contact"
          class="mobile-link flex w-full justify-center rounded-xl bg-sky-600 px-6 py-4 text-base font-bold text-white shadow-md transition-colors hover:bg-sky-700"
          >Contáctanos</a
        >
      </li>
    </ul>
  </div>
</div>

<script>
  const toggle = document.getElementById("mobile-menu-toggle");
  const menu = document.getElementById("mobile-menu");
  const menuIcon = document.getElementById("menu-icon");
  const closeIcon = document.getElementById("close-icon");
  const links = document.querySelectorAll(".mobile-link");

  function toggleMenu() {
    const isHidden = menu?.classList.contains("hidden");
    if (isHidden) {
      menu?.classList.remove("hidden");
      // Optional: add a slight animation class via Tailwind
      menu?.classList.add(
        "animate-in",
        "slide-in-from-top-4",
        "fade-in",
        "duration-200",
      );
      setTimeout(() => {
        menu?.classList.remove(
          "animate-in",
          "slide-in-from-top-4",
          "fade-in",
          "duration-200",
        );
      }, 200);
      menuIcon?.classList.add("hidden");
      closeIcon?.classList.remove("hidden");
      toggle?.setAttribute("aria-expanded", "true");
    } else {
      menu?.classList.add("hidden");
      menuIcon?.classList.remove("hidden");
      closeIcon?.classList.add("hidden");
      toggle?.setAttribute("aria-expanded", "false");
    }
  }

  toggle?.addEventListener("click", toggleMenu);
  links.forEach((link) =>
    link.addEventListener("click", () => {
      menu?.classList.add("hidden");
      menuIcon?.classList.remove("hidden");
      closeIcon?.classList.add("hidden");
      toggle?.setAttribute("aria-expanded", "false");
    }),
  );
</script>
